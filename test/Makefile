## This is a makefile for the example programs for JParse, the Java parser.
## It may depend on features of GNU make.  If other makes fail, please send
## a bug report (and, better yet, a fix) to the JParse project maintainer:
## Jerry James <jamesj@acm.org>.

## JParse is free software; you can redistribute it and/or modify it
## under the terms of the GNU Lesser General Public License as published
## by the Free Software Foundation; either version 2.1, or (at your
## option) any later version.

## JParse is distributed in the hope that it will be useful, but WITHOUT
## ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
## FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public
## License for more details.

## You should have received a copy of the GNU Lesser General Public
## License along with JParse; see the file COPYING.  If not, write to
## the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
## Boston, MA 02111-1307, USA.

## make           to build the class files for the JParse example programs
## make debug     to build a debugging version of the class files
## make clean     to remove backup and autosave files
## make distclean to remove all files that can be created with this
##                makefile


######################### User configurable options ##########################

# The Java runtime to use (e.g., java, kaffe)
JAVA = java

# The Java compiler to use (e.g., javac, jikes, pizza)
JAVAC = javac

# Compilation flags.
ifdef DEBUG
JFLAGS = -g -source 1.4 -deprecation
else
JFLAGS = -O -source 1.4
endif

###################### End of user configurable options ######################
################### Do not change anything below this line ###################

# All of the files generated from java.print.g
JPRINTER_SRC = JavaPrinter.java JavaPrinterTokenTypes.java
JPRINTER_CLS = JavaPrinter.class JavaPrinterTokenTypes.class
JPRINTER_TXT = JavaPrinterTokenTypes.txt

# All of the files generated from java.type.g
JTYPER_SRC = JavaTyper.java JavaTyperTokenTypes.java
JTYPER_CLS = JavaTyper.class JavaTyperTokenTypes.class
JTYPER_TXT = JavaTyperTokenTypes.txt

# All of the text files generated by ANTLR
TEXT = $(JPRINTER_TXT) $(JTYPER_TXT)

# All of the .class files
CLASS = JavaCopy.class JavaType.class

.PHONY:	all debug clean distclean

all: JavaTokenTypes.txt $(JPRINTER_CLS) $(JTYPER_CLS) $(CLASS)

debug:
	$(MAKE) all DEBUG=1

JavaTokenTypes.txt: ../jparse/JavaTokenTypes.txt
	cp ../jparse/JavaTokenTypes.txt .

$(JPRINTER_SRC): java.print.g JavaTokenTypes.txt
	$(JAVA) antlr.Tool java.print.g

$(JTYPER_SRC): java.type.g JavaTokenTypes.txt
	$(JAVA) antlr.Tool java.type.g

%.class: %.java
	$(JAVAC) $(JFLAGS) $<

clean:
	rm -f *~

distclean: clean
	rm -f $(JPRINTER_SRC) $(JTYPER_SRC) $(TEXT) JavaTokenTypes.txt *.class
